<h1>Orders</h1>

<table class="table table-striped shadow rounded m-2">
  <thead class="thead-dark">
    <tr>
        <th>State</th>
        <th>Quantity</th>
        <th>Product</th>
        <th>Total Price</th>
        <th>User</th>
        <th colspan="3">Actions</th>
    </tr>
</thead>
<tbody>
    <% if ! @orders.empty? %>
        <% @orders.each do |order| %>
          <% order.order_products.each do |ordprod| %>
            <tr>
                  <td><%= order.state %></td>

                  <td><%= ordprod.quantity %></td>

                  <td><%= ordprod.product.title %></td>

                  <td><%= ordprod.quantity * ordprod.product.price %></td>

                  <td><%= order.user_id %></td>

                <td><%= link_to 'Show', order, class: 'btn btn-primary' %></td>
                <td><%= link_to 'Order', edit_order_path(order), class: 'btn btn-success' %></td>
                <% if order.state != "Inorder"%>
                  <td><%= link_to 'Destroy', order, method: :delete, class: 'btn btn-danger' , data: { confirm: 'Are you sure?' } %></td>
                <% end %>
            </tr>
            <% end %>
            </tbody>
        <% end %>
    <% else %>
        <td colspan="11" style="text-align: center">No Orders Found</td>
    <% end %>

</table>

<%= link_to 'New Order', new_order_path, class: 'btn btn-outline-primary' %>
<%= link_to "Show Cart", show_cart_path, class: 'btn btn-outline-primary' %>
